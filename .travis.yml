language: java
install: true
before_install:
- openssl aes-256-cbc -K $encrypted_2d73bda5dc40_key -iv $encrypted_2d73bda5dc40_iv
  -in keyring.gpg.enc -out keyring.gpg -d
- chmod +x gradlew
stages:
- name: build
- name: snapshot
  if: branch = develop
- name: release
  if: branch = master
jobs:
  include:
  - stage: build
    script:
    - gpg --import keyring.asc
    - gpg --dearmor keyring.asc
    - "./gradlew build"
  - stage: snapshot
    script:
    - gpg --import keyring.asc
    - gpg --dearmor keyring.asc
    - "./gradlew artifactoryPublish -x test -Dbuild.number=$TRAVIS_BUILD_NUMBER"
  - stage: release
    script:
    - gpg --import keyring.asc
    - gpg --dearmor keyring.asc
    - "./gradlew bintrayUpload -x test -Drelease=true -Dbuild.number=$TRAVIS_BUILD_NUMBER"
